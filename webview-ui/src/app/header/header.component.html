<div class="header-container">
	<vscode-button
		appearance="icon"
		[aria-label]="allCollapsed ? 'Expand all' : 'Collapse all'"
		[title]="allCollapsed ? 'Expand all' : 'Collapse all'"
		(click)="toggleAllCollapsed()"
		[disabled]="isListEmpty"
	>
		<span>
			<app-icon [name]="allCollapsed ? 'chevron-right' : 'chevron-down'"></app-icon>
		</span>
	</vscode-button>

	@if (!(enableWideView | async)) {
		<vscode-button
			appearance="icon"
			[aria-label]="'Wide View'"
			[title]="'Wide View'"
			(click)="setWideViewEnabled(true)"
		>
			<span>
				<app-icon name="wide-view"></app-icon>
			</span>
		</vscode-button>
	}
	@if (enableWideView | async) {
		<vscode-button
			appearance="icon"
			[aria-label]="'Normal View'"
			[title]="'Normal View'"
			(click)="setWideViewEnabled(false)"
		>
			<span>
				<app-icon name="normal-view"></app-icon>
			</span>
		</vscode-button>
	}

	<vscode-button
		appearance="icon"
		[aria-label]="'Sync Now'"
		[title]="'Sync Now'"
		(click)="syncNow()"
	>
		<span>
			<app-icon name="sync" [class.spinning]="isSyncing | async"></app-icon>
		</span>
	</vscode-button>

	<vscode-button
		appearance="icon"
		[matMenuTriggerFor]="settingsMenu"
		[aria-label]="'Settings'"
		[title]="'Settings'"
		(menuOpened)="onSettingsMenuOpened()"
		(menuClosed)="onSettingsMenuClosed()"
		[ngClass]="{ 'menu-open': isSettingsMenuOpen }"
	>
		<span>
			<app-icon name="settings"></app-icon>
		</span>
	</vscode-button>
	<!-- Settings menu -->
	<mat-menu #settingsMenu="matMenu" yPosition="below" xPosition="before">
		<!-- Export submenu -->
		<button mat-menu-item [matMenuTriggerFor]="exportMenu" aria-label="Export" class="submenu-item">
			<span class="submenu-content">
				<app-icon name="export"></app-icon>
				<span style="margin-left: 8px;">Export</span>
			</span>
			<app-icon name="chevron-right" class="submenu-arrow"></app-icon>
		</button>

		<!-- Import submenu -->
		<button mat-menu-item [matMenuTriggerFor]="importMenu" aria-label="Import" class="submenu-item">
			<span class="submenu-content">
				<app-icon name="import"></app-icon>
				<span style="margin-left: 8px;">Import</span>
			</span>
			<app-icon name="chevron-right" class="submenu-arrow"></app-icon>
		</button>

		<mat-divider></mat-divider>

		<!-- Sync mode options -->
		<button mat-menu-item (click)="selectUserSyncMode()" aria-label="Select User Sync Mode">
			Select User Sync Mode
		</button>
		<button mat-menu-item (click)="selectWorkspaceSyncMode()" aria-label="Select Workspace Sync Mode">
			Select Workspace Sync Mode
		</button>

		<mat-divider></mat-divider>

		<!-- GitHub section -->
		<fieldset>
			<legend>GitHub</legend>

			<!-- GitHub connect/disconnect -->
			@if (!(isGitHubConnected | async)) {
				<button mat-menu-item (click)="connectGitHub()" aria-label="Connect to GitHub">
					Connect to GitHub
				</button>
			}
			@if (isGitHubConnected | async) {
				<button mat-menu-item (click)="disconnectGitHub()" aria-label="Disconnect from GitHub">
					Disconnect from GitHub
				</button>
			}

			<!-- GitHub configuration options (disabled when not connected) -->
			<button
				mat-menu-item
				(click)="setGistId()"
				[disabled]="!(isGitHubConnected | async)"
				aria-label="Set Gist ID"
			>
				Set Gist ID
			</button>
			<button
				mat-menu-item
				(click)="setUserFile()"
				[disabled]="!(isGitHubConnected | async)"
				aria-label="Set User File"
			>
				Set User File
			</button>
			<button
				mat-menu-item
				(click)="setWorkspaceFile()"
				[disabled]="!(isGitHubConnected | async)"
				aria-label="Set Workspace File"
			>
				Set Workspace File
			</button>
		</fieldset>
	</mat-menu>

	<!-- Export submenu -->
	<mat-menu #exportMenu="matMenu">
		<button mat-menu-item (click)="export(ExportFormats.JSON)" aria-label="Export to JSON">
			JSON
		</button>
		<button mat-menu-item (click)="export(ExportFormats.MARKDOWN)" aria-label="Export to Markdown">
			Markdown
		</button>
	</mat-menu>

	<!-- Import submenu -->
	<mat-menu #importMenu="matMenu">
		<button mat-menu-item (click)="import(ImportFormats.JSON)" aria-label="Import from JSON">
			JSON
		</button>
		<button mat-menu-item (click)="import(ImportFormats.MARKDOWN)" aria-label="Import from Markdown">
			Markdown
		</button>
	</mat-menu>

	<vscode-button
		appearance="icon"
		[aria-label]="'Delete all items in this tab'"
		[title]="'Delete all items in this tab'"
		(click)="deleteAll()"
		[disabled]="isListEmpty"
	>
		<app-icon name="trash"></app-icon>
	</vscode-button>

	<vscode-button
		appearance="icon"
		[aria-label]="'Clear completed todos in this tab'"
		[title]="'Clear completed todos in this tab'"
		(click)="deleteCompleted()"
		[disabled]="!hasCompletedTodos"
	>
		<app-icon name="clear"></app-icon>
	</vscode-button>
</div>
